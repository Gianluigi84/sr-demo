<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro"
       xmlns:sensor="http://playerstage.sourceforge.net/gazebo/xmlschema/#sensor"
       xmlns:controller="http://playerstage.sourceforge.net/gazebo/xmlschema/#controller"
       xmlns:joint="http://playerstage.sourceforge.net/gazebo/xmlschema/#slider"
       xmlns:interface="http://playerstage.sourceforge.net/gazebo/xmlschema/#interface">

  <include filename="$(find sr_edc_defs)/defs/hand/hand_transmission.xacro" /> 
  <property name="M_PI" value="3.1415926535897931" />

  <!-- FIXME: all the limits are not valid -->
  <property name="wrj1_joint_effort_limit"  value="100.0" />
  <property name="wrj2_joint_effort_limit"  value="100.0" />
  
  <property name="wrj1_upper_angle" value="0.611" />
  <property name="wrj1_lower_angle" value="-0.786" />
  
  <property name="wrj2_upper_angle" value="0.175" />
  <property name="wrj2_lower_angle" value="-0.524" />
  
  <macro name="pr2_wrist1_limits" params="reflect">
    <limit effort="${wrj1_joint_effort_limit}" velocity="0.5"
           lower="${wrj1_lower_angle}" upper="${wrj1_upper_angle}" />
  </macro>
  
  <macro name="pr2_wrist2_limits" params="reflect">
    <limit effort="${wrj2_joint_effort_limit}" velocity="0.5"
           lower="${wrj2_lower_angle}" upper="${wrj2_upper_angle}" />
  </macro>

  
  <!-- FIXME: all the limits are not valid -->
  <property name="fj0_joint_effort_limit"  value="100.0" />
  <property name="fj3_joint_effort_limit"  value="100.0" />
  <property name="fj4_joint_effort_limit"  value="100.0" />
  
  <property name="fj0_upper_angle" value="3.142" />
  <property name="fj0_lower_angle" value="0.00" />
  
  <property name="fj3_upper_angle" value="1.571" />
  <property name="fj3_lower_angle" value="0.00" />

  <property name="fj4_upper_angle" value="0.436" />
  <property name="fj4_lower_angle" value="-0.436" />

  
  <macro name="pr2_ff0_limits" params="reflect">
    <limit effort="${fj0_joint_effort_limit}" velocity="1.0"
           lower="${fj0_lower_angle}" upper="${fj0_upper_angle}" />
  </macro>
  <macro name="pr2_ff3_limits" params="reflect">
    <limit effort="${fj3_joint_effort_limit}" velocity="1.0"
           lower="${fj3_lower_angle}" upper="${fj3_upper_angle}" />
  </macro>
  <macro name="pr2_ff4_limits" params="reflect">
    <limit effort="${fj4_joint_effort_limit}" velocity="1.0"
           lower="${fj4_lower_angle}" upper="${fj4_upper_angle}" />
  </macro>
  

  <macro name="pr2_mf0_limits" params="reflect">
    <limit effort="${fj0_joint_effort_limit}" velocity="1.0"
           lower="${fj0_lower_angle}" upper="${fj0_upper_angle}" />
  </macro>
  <macro name="pr2_mf3_limits" params="reflect">
    <limit effort="${fj3_joint_effort_limit}" velocity="1.0"
           lower="${fj3_lower_angle}" upper="${fj3_upper_angle}" />
  </macro>
  <macro name="pr2_mf4_limits" params="reflect">
    <limit effort="${fj4_joint_effort_limit}" velocity="1.0"
           lower="${fj4_lower_angle}" upper="${fj4_upper_angle}" />
  </macro>


  <macro name="pr2_rf0_limits" params="reflect">
    <limit effort="${fj0_joint_effort_limit}" velocity="1.0"
           lower="${fj0_lower_angle}" upper="${fj0_upper_angle}" />
  </macro>
  <macro name="pr2_rf3_limits" params="reflect">
    <limit effort="${fj3_joint_effort_limit}" velocity="1.0"
           lower="${fj3_lower_angle}" upper="${fj3_upper_angle}" />
  </macro>
  <macro name="pr2_rf4_limits" params="reflect">
    <limit effort="${fj4_joint_effort_limit}" velocity="1.0"
           lower="${fj4_lower_angle}" upper="${fj4_upper_angle}" />
  </macro>


  <property name="lfj5_joint_effort_limit"  value="100.0" />
  <property name="lfj5_upper_angle" value="0.698" />
  <property name="lfj5_lower_angle" value="0.0" />

  <macro name="pr2_lf0_limits" params="reflect">
    <limit effort="${fj0_joint_effort_limit}" velocity="1.0"
           lower="${fj0_lower_angle}" upper="${fj0_upper_angle}" />
  </macro>
  <macro name="pr2_lf3_limits" params="reflect">
    <limit effort="${fj3_joint_effort_limit}" velocity="1.0"
           lower="${fj3_lower_angle}" upper="${fj3_upper_angle}" />
  </macro>
  <macro name="pr2_lf4_limits" params="reflect">
    <limit effort="${fj4_joint_effort_limit}" velocity="1.0"
           lower="${fj4_lower_angle}" upper="${fj4_upper_angle}" />
  </macro>
  <macro name="pr2_lf5_limits" params="reflect">
    <limit effort="${lfj5_joint_effort_limit}" velocity="1.0"
           lower="${lfj5_lower_angle}" upper="${lfj5_upper_angle}" />
  </macro>


  <property name="thj1_joint_effort_limit"  value="100.0" />
  <property name="thj2_joint_effort_limit"  value="100.0" />
  <property name="thj3_joint_effort_limit"  value="100.0" />
  <property name="thj4_joint_effort_limit"  value="100.0" />
  <property name="thj5_joint_effort_limit"  value="100.0" />
  
  <property name="thj1_upper_angle" value="1.571" />
  <property name="thj1_lower_angle" value="0.00" />
  
  <property name="thj2_upper_angle" value="0.524" />
  <property name="thj2_lower_angle" value="-0.524" />

  <property name="thj3_upper_angle" value="0.262" />
  <property name="thj3_lower_angle" value="-0.262" />

  <property name="thj4_upper_angle" value="1.309" />
  <property name="thj4_lower_angle" value="0.0" />

  <property name="thj5_upper_angle" value="1.047" />
  <property name="thj5_lower_angle" value="-1.047" />

  <macro name="pr2_th1_limits" params="reflect">
    <limit effort="${thj1_joint_effort_limit}" velocity="1.0"
           lower="${thj1_lower_angle}" upper="${thj1_upper_angle}" />
  </macro>
  <macro name="pr2_th2_limits" params="reflect">
    <limit effort="${thj2_joint_effort_limit}" velocity="1.0"
           lower="${thj2_lower_angle}" upper="${thj2_upper_angle}" />
  </macro>
  <macro name="pr2_th3_limits" params="reflect">
    <limit effort="${thj3_joint_effort_limit}" velocity="1.0"
           lower="${thj3_lower_angle}" upper="${thj3_upper_angle}" />
  </macro>
  <macro name="pr2_th4_limits" params="reflect">
    <limit effort="${thj4_joint_effort_limit}" velocity="1.0"
           lower="${thj4_lower_angle}" upper="${thj4_upper_angle}" />
  </macro>
  <macro name="pr2_th5_limits" params="reflect">
    <limit effort="${thj5_joint_effort_limit}" velocity="1.0"
           lower="${thj5_lower_angle}" upper="${thj5_upper_angle}" />
  </macro>

  <macro name="pr2_sr_hand" params="name side parent *origin gear_ratio screw_reduction theta0 phi0 t0 L0 h a b r">

    <joint name="srh_wrj2_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="world"/>
      <child link="sr_wrist_dummy_link" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="0 1 0" />
      <pr2_wrist2_limits reflect="1" />
    </joint>
    <link name="sr_wrist_dummy_link">
    </link>
    <joint name="srh_wrj1_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_wrist_dummy_link"/>
      <child link="sr_hand_palm_link"/>
      <origin xyz="0 0 0.034" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_wrist1_limits reflect="1" />
    </joint>
    <link name="sr_hand_palm_link">
      
    </link>

    <!-- ........................................ -->

    <joint name="srh_ffj4_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_palm_link"/>
      <child link="sr_hand_ff4_link"/>
      <origin xyz="0.033 0 0.095" rpy="0 0 0" />
      <axis xyz="0 -1 0" />
      <pr2_ff4_limits reflect="1" />
    </joint>
    <link name="sr_hand_ff4_link">
      
    </link>
    
    <joint name="srh_ffj3_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_ff4_link"/>
      <child link="sr_hand_ff3_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_ff3_limits reflect="1" />
    </joint>
    <link name="sr_hand_ff3_link">
      
    </link>
    
    <joint name="srh_ffj0_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_ff3_link"/>
      <child link="sr_hand_ff0_link"/>
      <origin xyz="0 0 0.025" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_ff0_limits reflect="1" />
    </joint>
    <link name="sr_hand_ff0_link">
      
    </link>
    
    <!-- ........................................ -->
    
    <joint name="srh_mfj4_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_palm_link"/>
      <child link="sr_hand_mf4_link"/>
      <origin xyz="0.011 0 0.099" rpy="0 0 0" />
      <axis xyz="0 -1 0" />
      <pr2_mf4_limits reflect="1" />
    </joint>
    <link name="sr_hand_mf4_link">
      
    </link>
    
    <joint name="srh_mfj3_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_mf4_link"/>
      <child link="sr_hand_mf3_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_mf3_limits reflect="1" />
    </joint>
    <link name="sr_hand_mf3_link">
      
    </link>
    
    <joint name="srh_mfj0_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_mf3_link"/>
      <child link="sr_hand_mf0_link"/>
      <origin xyz="0 0 0.045" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_mf0_limits reflect="1" />
    </joint>
    <link name="sr_hand_mf0_link">
      
    </link>
    
    <!-- ........................................ -->
    
    <joint name="srh_rfj4_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_palm_link"/>
      <child link="sr_hand_rf4_link"/>
      <origin xyz="-0.011 0 0.095" rpy="0 0 0" />
      <axis xyz="0 1 0" />
      <pr2_rf4_limits reflect="1" />
    </joint>
    <link name="sr_hand_rf4_link">
      
    </link>
    
    <joint name="srh_rfj3_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_rf4_link"/>
      <child link="sr_hand_rf3_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_rf3_limits reflect="1" />
    </joint>
    <link name="sr_hand_rf3_link">
      
    </link>
    
    <joint name="srh_rfj0_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_rf3_link"/>
      <child link="sr_hand_rf0_link"/>
      <origin xyz="0 0 0.045" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_rf0_limits reflect="1" />
    </joint>
    <link name="sr_hand_rf0_link">
      
    </link>
    
    <!-- ........................................ -->
    
    <joint name="srh_lfj5_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_palm_link"/>
      <child link="sr_hand_lf5_link"/>
      <origin xyz="-0.01671 0 0.044" rpy="0 0 0" />
      <axis xyz="0.57 0 0.82" />
      <pr2_lf5_limits reflect="1" />
    </joint>
    <link name="sr_hand_lf5_link">
      
    </link>
    
    <joint name="srh_lfj4_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_lf5_link"/>
      <child link="sr_hand_lf4_link"/>
      <origin xyz="-0.01629 0 0.0425" rpy="0 0 0" />
      <axis xyz="0 1 0" />
      <pr2_lf4_limits reflect="1" />
    </joint>
    <link name="sr_hand_lf4_link">
      
    </link>
    
    <joint name="srh_lfj3_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_lf4_link"/>
      <child link="sr_hand_lf3_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_lf3_limits reflect="1" />
    </joint>
    <link name="sr_hand_lf3_link">
      
    </link>
    
    <joint name="srh_lfj0_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_lf3_link"/>
      <child link="sr_hand_lf0_link"/>
      <origin xyz="0 0 0.045" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_lf0_limits reflect="1" />
    </joint>
    <link name="sr_hand_lf0_link">
      
    </link>
    
    <!-- ........................................ -->
    
    <joint name="srh_thj5_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_palm_link"/>
      <child link="sr_hand_th5_link"/>
      <origin xyz="0.034 -0.0085 0.02924" rpy="0 0.7855 0" />
      <axis xyz="0 0 -1" />
      <pr2_th5_limits reflect="1" />
    </joint>
    <link name="sr_hand_th5_link">
      
    </link>
    
    <joint name="srh_thj4_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_th5_link"/>
      <child link="sr_hand_th4_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_th4_limits reflect="1" />
    </joint>
    <link name="sr_hand_th4_link">
      
    </link>
    
    <joint name="srh_thj3_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_th4_link"/>
      <child link="sr_hand_th3_link"/>
      <origin xyz="0 0 0.038" rpy="0 0 0" />
      <axis xyz="1 0 0" />
      <pr2_th3_limits reflect="1" />
    </joint>
    <link name="sr_hand_th3_link">
      
    </link>
    
    <joint name="srh_thj2_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_th3_link"/>
      <child link="sr_hand_th2_link"/>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="0 -1 0" />
      <pr2_th2_limits reflect="1" />
    </joint>
    <link name="sr_hand_th2_link">
      
    </link>
    
    <joint name="srh_thj1_joint" type="revolute">
      <insert_block name="origin"/>
      <parent link="sr_hand_th2_link"/>
      <child link="sr_hand_th1_link"/>
      <origin xyz="0 0 0.032" rpy="0 0 0" />
      <axis xyz="0 -1 0" />
      <pr2_th1_limits reflect="1" />
    </joint>
    <link name="sr_hand_th1_link">
      
    </link>
    
    <!-- ........................................ -->
    

    <sr_hand_wrist_transmission joint_name="wr" />
    <sr_hand_finger_transmission joint_name="ff" />
    <sr_hand_finger_transmission joint_name="mf" />
    <sr_hand_finger_transmission joint_name="rf" />
    <sr_hand_littlefinger_transmission />
    <sr_hand_thumb_transmission joint_name="th" />

  </macro>

</robot>
